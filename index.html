<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>导航网站</title>
  <link rel="stylesheet" type="text/css" href="./assets/css/style.css">
  <link rel="stylesheet" type="text/css" href="./assets/css/reset.css">
  <link rel="stylesheet" type="text/css" href="./assets/css/media.small.css">
  <link rel="stylesheet" type="text/css" href="./assets/css/media.large.css">
  <link rel="stylesheet" type="text/css" href="./assets/css/iconfont.css">
  <script defer src="./assets/js/alpine.min.js"></script>
  <!-- <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script> -->
</head>

<body>
  <div class="app view-small view-large">
    <!-- 搜索区域 -->
    <div x-data="search" class="search-container">
      <div class="search-content">
        <ul class="search-list">
          <template x-for="item in list">
            <li x-text="item.name" :class="currentSearchCateGory === item.key ? 'active' : '' " role="button"
              @click="onSearchListItem(item)"></li>
          </template>
        </ul>
        <div class="search-box">
          <div class="select-box" @click="showSelectBox" role="button">
            <template x-if="!currentSearchData.icon">
              <div x-text="currentSearchData.name"></div>
            </template>
            <template x-if="currentSearchData.icon">
              <span :class="`icon-custom-suf iconfont ${currentSearchData.icon}`"></span>
            </template>
            <ul class="select" x-show="showSelect" x-transition">
              <template x-for="item in listItem">
                <li role="button" :value="item.key" x-text="item.name" @click="e => onSelectItem(item, e)">
                  </option>
              </template>
            </ul>
          </div>
          <input type="text" x-model="content" @keyup.enter="onSearch" />
          <span class="icon-custom-search iconfont icon-search" role="button" @click="onSearch"></span>
        </div>
      </div>
    </div>

    <!-- 主要应用区域 -->
    <div x-data="nav" class="main-container">
      <div class="title">常用应用</div>
      <ul class="app-list grid-small" :style="{
        'overflow': showExpand ? 'hidden' : 'visible',
        'height': showExpand ? '72px' : 'auto'
      }">
        <template x-for="(item,index) in commonList">
          <li class="app-item" role="button" @click="onCommonItem(item, index === currentExpandIndex)">
            <template x-if="!(index === currentExpandIndex)">
              <img :src="getFavicon(item.url)" alt="">
            </template>

            <template x-if="(index === currentExpandIndex)">
              <div style="height: 30px;">
                <template x-if="showExpand">
                  <span class="iconfont icon-zhankai img"></span>
                </template>
                <template x-if="!showExpand">
                  <img :src="getFavicon(item.url)" alt="">
                </template>
              </div>
            </template>
            
            <div class="app-item-title" x-text="(index === currentExpandIndex) && showExpand ? '展开' : item.title" :title="(index === currentExpandIndex) && showExpand ? '展开' : item.title"></div>
          </li>
        </template>
        <template x-if="!showExpand">
          <li class="app-item" role="button" @click="showExpand = true">
            <span class="iconfont icon-shouqi img"></span>
            <div class="app-item-title">收起</div>
          </li>
        </template>

        <!-- <template x-if="showExpand">
          <li class="expand" role="button">展开</li>
        </template> -->
      </ul>

      <div class="title" style="margin-top: 30px">目录</div>
      <ul class="common-list">
        <template x-for="item in commonClassList">
          <li x-text="item.title" role="button" @click="onTabChange(item)" :class="{
            'common-list-item': true,
            'active': item.id === currentActiveItem.id
          }"></li>
        </template>
      </ul>

      <div class="current-list">
        <template x-if="level !== 1">
          <li class="app-item" role="button" @click="onBack">
            <span class="iconfont icon-subdirectory-arrow-l" style="margin-right: 10px;"></span>
            <div>返回</div>
          </li>
        </template>

        <li class="current-nav-dir grid-small">
          <template x-for="item in _.filter(currentActiveItem.children, 'children')">
            <template x-if="!item.title.includes('隐藏')">
              <li class="app-item" role="button" @click="onDirectoryChange(item)">
                <span class="iconfont icon-directory" style="margin-right: 10px;"></span>
                <div class="app-item-title" x-text="item.title"></div>
              </li>
            </template>
          </template>
        </li>

        <li class="current-nav-list">
          <template x-for="item in _.filter(currentActiveItem.children, 'url')">
            <template x-if="!item.title.includes('隐藏')">
              <li class="app-item" role="button" @click="window.open(item.url)">
                <img :src="getFavicon(item.url)" alt="">
                <div class="app-item-title" x-text="item.title" :title="item.title"></div>
              </li>
            </template>
          </template>
        </li>
      </div>
    </div>
  </div>

  <script src="./assets/js/data.js"></script>
  <script src="./assets/js/axios.min.js"></script>
  <script src="./assets/js/lodash.min.js"></script>
  <script src="./assets/js/search.js"></script>
  <script src="./assets/js/nav.js"></script>
  <script>
    document.addEventListener('alpine:init', () => {
      Alpine.data('search', searchData)
      Alpine.data('nav', navData)
    })
  </script>
</body>

</html>